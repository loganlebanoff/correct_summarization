<link rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

<!-- Instructions -->
<section id="instructions">
    <div class="row mx-0">
        <div class="col-12 col-md-6">
            <div class="card my-4">
                <div class="card-header"><h5 class="mb-0">Instructions</h5></div>
                <div class="card-body">
                    <p><em>Thanks for participating in our study!</em></p>
                    <p>
                        <strong>Description: </strong> We need your help to evaluate
                        "well-formedness" of sentences. These sentences were
                        composed by a Artificial Intelligence powered system.
                    </p>
                    <p class="mb-0"><strong>What we need <em>you</em> to do:</strong></p>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        Rank (from 1-4) the following sentences by their
                        <strong>grammatical correctness</strong>. These sentences
                        were generated by different systems, but are expected to
                        convey similar meanings.
                    </li>
                    <li class="list-group-item">
                        For each sentence, determine whether the meaning of a
                        "subject-verb-object" triplet has been captured by the
                        sentence.
                    </li>
                    <li class="list-group-item">
                        Lastly, judge if the sentence has introduced an
                        <strong>NEW</strong> meanings, which are
                        <strong>NOT</strong> captured by the collection of triplets.
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-12 col-md-6">
            <div class="card my-4">
                <div class="card-header"><h5 class="mb-0">Some examples:</h5></div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <blockquote class="blockquote border-left pl-3" style="border-width: 4px !important;">
                            albert b. white was born in parkersburg , virginia , and died on july in parkersburg , west virginia
                        </blockquote>
                        <div class="alert alert-info"><strong>Triplet: </strong> (Albert_B._White | dateOfDeath | 1941-07-03)</div>
                        <p>Does this sentence contain the meaning of the triplet above?</p>
                        <div class="alert alert-success">
                            <strong>Yes</strong>; partial matches are acceptable. e.g. "died on july" indicates "dateOfDeath"
                            is "07" â€“ though the exact date is "1941-07-03."
                        </div>
                    </li>
                    <li class="list-group-item">
                        <blockquote class="blockquote border-left pl-3" style="border-width: 4px !important;">
                            albert b. white was born in parkersburg , virginia , and died on july in parkersburg , west virginia
                        </blockquote>
                        <div class="alert alert-info"><strong>Triplet: </strong>
                            (Albert_B._White | dateOfDeath | 1941-07-03), (Albert_B._White | deathPlace | Parkersburg,_West_Virginia)
                        </div>
                        <p>
                            Does this sentence convey <strong>new</strong> meanings which are <strong>not</strong> captured
                            by the above triplets?
                        </p>
                        <div class="alert alert-success">
                            <strong>Yes</strong>; "albert b. white was born in parkersburg , virginia" is something NEW and
                            not included in the tuples.
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>
<!-- /Instructions -->


<script>
    function putArticle(articleSents) {
        let article = document.getElementById("src-article");
        let idx = 0;
        articleSents.forEach(function (sent) {
            let p = document.createElement("p");
            p.id = `sent${idx}`;
            p.innerText = sent;
            p.setAttribute("class", "alert");
            article.appendChild(p);
            idx++;
        })
    }


    let usedColors = new Set();

    function addYNQuestion(text, name) {
        let wrapper = document.createElement("div");
        wrapper.setAttribute("class", "d-md-flex mb-3");
        wrapper.innerHTML = `
                <div class="p-0 m-0 col-12 col-md-8 m-0 d-flex flex-column text-center text-md-left">
                    <p class="mx-0 my-md-auto mb-3">${text}</p>
                </div>
                <div class="p-0 m-0 col-12 col-md-4 btn-group btn-group-toggle justify-content-center justify-content-md-end" data-toggle="buttons">
                    <label class="btn btn-success d-flex flex-column"><input type="radio" name="${name}">
                        <p class="my-auto">YES</p>
                    </label>
                    <label class="btn btn-danger d-flex flex-column"><input type="radio" name="${name}">
                        <p class="my-auto">NO</p>
                    </label>
                </div>`;

        return wrapper;
    }

    function newColor() {
      const hBase = Math.random();
      const newH = Math.floor(hBase * 360);
      const newL = Math.floor(Math.random() * 16) + 75;

      return `hsl(${newH}, 100%, ${newL}%)`;
    }

    function addSummary(idx, sent) {
        let tasks = document.getElementById("tasks");

        let card = document.createElement("div");
        card.setAttribute("class", "alert summary-sent");
        let color = null;
        do {
            color = newColor();
        } while (usedColors.has(color));
        usedColors.add(color);
        card.style.backgroundColor = color;
        card.id = `summary${idx}`;
        card.setAttribute("data-srcs", sent.srcs);

        let summary = document.createElement("p");
        summary.setAttribute("class", "text-justify");
        summary.innerText = sent.sent;

        card.appendChild(summary);

        card.appendChild(document.createElement("hr"));

        card.appendChild(
            addYNQuestion(
                "Is this sentence <strong>true to the original article?</strong>",
                `Accuracy_${idx}`));

        card.appendChild(
            addYNQuestion(
                "Is this sentence <strong>true to the original article?</strong>",
                `Accuracy_${idx}`));

        tasks.appendChild(card);

        card.addEventListener("mouseenter", function () {
            let srcs = card.getAttribute("data-srcs").split(",");
            srcs.forEach(function (id) {
                document.getElementById(`sent${id}`).style.backgroundColor = card.style.backgroundColor;
            })
        });

        card.addEventListener("mouseleave", function () {
            let srcs = card.getAttribute("data-srcs").split(",");
            srcs.forEach(function (id) {
                document.getElementById(`sent${id}`).style.backgroundColor = "#fff";
            })
        })
    }
</script>


<!-- Tasks -->
<section id="tasks-to-complete">
    <div class="row mx-0">
        <div class="col-12 col-md-8 text-justify">
            <div class="card border-secondary">
                <div class="card-header bg-secondary text-light text-center"><strong>Source Article</strong></div>
                <div class="card-body" id="src-article"></div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card">
                <div class="card-header text-center"><strong>Summary Sentences</strong></div>
                <div class="card-body">
                    <fieldset id="tasks">
                    </fieldset>
                </div>
            </div>
        </div>
    </div>
    <p hidden="">${qID}, ${Document}</p>
    <p hidden=""></p>
    <script>
        sourceArticle = [
            "Lorem Ipsum is simply dummy text of the printing and typesetting industry.",
            "Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.",
            "It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.",
            "It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum."
        ];
        putArticle(sourceArticle);

        testSummaries = [
            {
                "srcs": [0, 1],
                "sent": "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.",
            },
            {
                "srcs": [2],
                "sent": "Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.",
            }
        ];

        let idx = 0;
        testSummaries.forEach(function (value) {
            addSummary(idx,  value);
            idx++;
        });
    </script>
</section>

<style>
    p[id^="sent"] {
        transition: background-color 200ms ease-in-out;
        /*border-color: rgba(25, 25, 25, 0.25);*/
        margin-bottom: 0.25em;
        -webkit-border-radius: 0;
        -moz-border-radius: 0;
        border-radius: 0.25em;
        /*padding: 0.25em 0.5em;*/
    }

    div.summary-sent > div:last-child {
        margin: 0 !important;
    }
</style>
<!-- /Tasks -->
