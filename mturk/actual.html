<link rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

<!-- Instructions -->
<section class="col-12 my-4" id="instructions">
    <div class="card border-info">
        <div class="card-header bg-info text-white text-center">
            <h5 class="m-0">Instructions</h5>
        </div>
        <div class="card-body row">
            <p class="d-block col-12 text-center"><em>Firstly, thanks for
                participating in our study!</em></p>
            <div class="col-12 col-md-6">
                <p><strong>Description: </strong> We have machine-generated (AI)
                    summaries of an Article. Each summary pulls from 0-2 article
                    sentences to create the result you see.</p>
                
                <p class="mb-0"><strong>What we need <em>you</em> to do:</strong></p>
                <ol class="list">
                    <li class="list-item">
                        <strong>Read the entire article.</strong> (It
                        should be a pretty quick read.)
                    </li>
                    <li class="list-item">
                        Go through each the <a href="#summaries">Summaries</a>,
                        hover over each to highlight the corresponding
                        sentences in the article. <strong>Read each summary
                        and answer the following questions:</strong>
                        <ol class="list">
                            <li class="list-item">
                                Is this sentence true to the original
                                article?
                            </li>
                            <li class="list-item">
                                Does this sentence contain information not
                                represented by the highlighted sentences?
                            </li>
                            <li class="list-item">
                                Is this sentence grammatically correct?
                            </li>
                        </ol>
                    </li>
                </ol>
            </div>
            <div class="col-12 col-md-6">
                <blockquote class="blockquote border-left pl-3"
                            style="border-width: 4px !important;">
                    Some pairs of sentences...
                </blockquote>
                <p><strong>Summary: </strong> some summary </p>
                <ol class="list">
                    <li class="list-item">
                        <p class="m-1 d-flex justify-content-between">
                            <span class="d-flex flex-column justify-content-center">
                                <strong>Is this sentence true to the
                                    original article?</strong>
                            </span>
                            <span class="btn-group">
                                <span class="btn btn-sm btn-success d-flex flex-column justify-content-center">YES</span>
                                <span class="btn btn-sm btn-danger d-flex flex-column justify-content-center">NO</span>
                            </span>
                        </p>
                        <p class="m-0">
                            <span class="btn btn-sm btn-success">YES</span>
                            While we don't show the entire article, this
                            summary is true to the original article it's
                            been sourced from.
                        </p>
                    </li>
                    <li class="list-item">
                        <p class="m-1 d-flex justify-content-between">
                            <span class="d-flex flex-column justify-content-center">
                                <strong>Does this sentence contain
                                    information not represented by the
                                    highlighted sentences?</strong>
                            </span>
                            <span class="btn-group">
                                <span class="btn btn-sm btn-success d-flex flex-column justify-content-center">YES</span>
                                <span class="btn btn-sm btn-danger d-flex flex-column justify-content-center">NO</span>
                            </span>
                        </p>
                        <p class="m-0">
                            <span class="btn btn-sm btn-danger">NO</span>
                            While we don't show the entire article, this
                            summary only contains information presented
                            in the sentences cited above.
                        </p>
                    </li>
                    <li class="list-item">
                        <p class="m-1 d-flex justify-content-between">
                            <span class="d-flex flex-column justify-content-center">
                                <strong>Is this sentence grammatically
                                    correct?</strong>
                            </span>
                            <span class="btn-group">
                                <span class="btn btn-sm btn-success d-flex flex-column justify-content-center">YES</span>
                                <span class="btn btn-sm btn-danger d-flex flex-column justify-content-center">NO</span>
                            </span>
                        </p>
                        <p class="m-0">
                            <span class="btn btn-sm btn-success">YES</span>
                            This sentence flows well, and reads as if
                            were spoken by someone with mastery over
                            English grammar.
                        </p>
                    </li>
                </ol>
            </div>
        </div>
    </div>
</section>
<!-- /Instructions -->


<script>
    function putArticle(articleSents) {
        let article = document.getElementById("src-article-content");
        let idx = 0;
        articleSents.forEach(function (sent) {
            let p = document.createElement("p");
            p.id = `sent${idx}`;
            p.innerText = sent;
            p.setAttribute("class", "alert py-1 px-2");
            article.appendChild(p);
            idx++;
        })
    }

    let usedColors = new Set();

    function addYNQuestion(text, name) {
        let wrapper = document.createElement("div");
        wrapper.setAttribute("class", "d-md-flex mb-3");
        wrapper.innerHTML = `
                <div class="p-0 m-0 col-12 col-md-8 m-0 d-flex flex-column text-center text-md-left">
                    <p class="mx-0 my-md-auto mb-3">${text}</p>
                </div>
                <div class="p-0 m-0 col-12 col-md-4 btn-group btn-group-toggle justify-content-center justify-content-md-end" data-toggle="buttons">
                    <label class="btn btn-sm btn-success d-flex flex-column"><input type="radio" name="${name}">
                        <p class="my-auto">YES</p>
                    </label>
                    <label class="btn btn-sm btn-danger d-flex flex-column"><input type="radio" name="${name}">
                        <p class="my-auto">NO</p>
                    </label>
                </div>`;

        return wrapper;
    }

    function newColor() {
      const hBase = Math.random();
      const newH = Math.floor(hBase * 360);
      const newL = Math.floor(Math.random() * 16) + 75;

      return `hsl(${newH}, 100%, ${newL}%)`;
    }

    function addSummary(idx, sent) {
        let tasks = document.getElementById("tasks");

        let card = document.createElement("div");
        card.setAttribute("class", "alert summary-sent px-2 py-1 pb-2 my-2");
        let color = null;
        do {
            color = newColor();
        } while (usedColors.has(color));
        usedColors.add(color);
        card.style.backgroundColor = color;
        card.id = `summary${idx}`;
        card.setAttribute("data-srcs", sent.srcs);

        let summary = document.createElement("p");
        summary.setAttribute("class", "mb-1");
        summary.innerText = sent.sent;

        card.appendChild(summary);

        let hr = document.createElement("hr");
        hr.setAttribute("class", "my-2")
        card.appendChild(hr);

        card.appendChild(
            addYNQuestion(
                "Is this sentence <strong>true to the original article?</strong>",
                `Accuracy_${idx}`));

        card.appendChild(
            addYNQuestion(
                "Does this sentence <strong>contain information not " +
                "represented by the highlighted sentences?</strong>",
                `ExtraInfo_${idx}`));

        card.appendChild(
            addYNQuestion(
                "Is this sentence <strong>grammatically correct?</strong>",
                `Grammatical_${idx}`));

        tasks.appendChild(card);

        card.addEventListener("mouseenter", function () {
            let srcs = card.getAttribute("data-srcs").split(",");
            srcs.forEach(function (id) {
                document.getElementById(`sent${id}`).style.backgroundColor = card.style.backgroundColor;
            })
        });

        card.addEventListener("mouseleave", function () {
            let srcs = card.getAttribute("data-srcs").split(",");
            srcs.forEach(function (id) {
                document.getElementById(`sent${id}`).style.backgroundColor = "#fff";
            })
        })
    }
</script>


<!-- Tasks -->
<section id="tasks-to-complete">
    <div class="row mx-0">
        <div class="col-12 col-md-6" id="src-article">
            <div class="card border-secondary">
                <div class="card-header bg-secondary text-light text-center"><strong>Article</strong></div>
                <div class="card-body p-2" id="src-article-content"></div>
            </div>
        </div>
        <div class="col-12 col-md-6" id="summaries">
            <div class="card">
                <div class="card-header text-center"><strong>Summary Sentences</strong></div>
                <div class="card-body p-2">
                    <fieldset id="tasks">
                    </fieldset>
                </div>
            </div>
        </div>
    </div>
    <p hidden="">${qID}, ${Document}</p>
    <p hidden=""></p>
    <script>
        sourceArticle = [
            "Lorem Ipsum is simply dummy text of the printing and typesetting industry.",
            "Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.",
            "It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.",
            "It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum."
        ];
        putArticle(sourceArticle);

        testSummaries = [
            {
                "srcs": [0, 1],
                "sent": "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.",
            },
            {
                "srcs": [2],
                "sent": "Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.",
            }
        ];

        let idx = 0;
        testSummaries.forEach(function (value) {
            addSummary(idx,  value);
            idx++;
        });
    </script>
</section>

<style>
    p[id^="sent"] {
        transition: background-color 200ms ease-in-out;
        /*border-color: rgba(25, 25, 25, 0.25);*/
        margin-bottom: 0.25em;
        -webkit-border-radius: 0;
        -moz-border-radius: 0;
        border-radius: 0.25em;
        /*padding: 0.25em 0.5em;*/
    }

    div.summary-sent > div:last-child {
        margin: 0 !important;
    }
</style>
<!-- /Tasks -->
